# ?? Respawn System - Visual Flow Diagram

## ?? Complete System Flow

```
???????????????????????????????????????????????????????????????????
?                    PLAYER GAMEPLAY CYCLE                        ?
???????????????????????????????????????????????????????????????????

????????????????????
?  Player in Game  ?
?   (Forest Area)  ?
????????????????????
         ?
         ? Walks to save station
         ?
????????????????????
?  At Save Station ??????? Proximity Trigger
?   Press E to Save?       (SaveStation.cs)
????????????????????
         ?
         ? Player presses E
         ?
????????????????????????????????????????????????????????????
?  SAVE PROCESS                                            ?
????????????????????????????????????????????????????????????
?  1. SaveStation records position: (10, 0, 15)           ?
?  2. SaveManager.SaveGame() called                       ?
?  3. SaveData updated:                                   ?
?     • saveStationPosition = (10, 0, 15)                ?
?     • playerHealth = 80                                ?
?     • playerMaxHealth = 100                            ?
?     • skills.level = 5                                 ?
?     • currentSceneName = "ForestArea"                  ?
?  4. JSON written to disk                               ?
????????????????????????????????????????????????????????????
         ?
         ? ? Save Complete!
         ?
????????????????????
? Player continues ?
?    exploring     ?
????????????????????
         ?
         ? Press M (Map key)
         ?
???????????????????????????????????????????????????????????
?  TRANSITION TO MAP                                      ?
???????????????????????????????????????????????????????????
?  1. SceneConnectionManager.ReturnToMap() called        ?
?  2. Scene "MapScene" loads                             ?
?  3. MapController initializes                          ?
?  4. CheckForSaveReturn() reads SaveData                ?
?  5. Forest Area highlighted (saved area indicator)     ?
???????????????????????????????????????????????????????????
         ?
         ?
         ?
????????????????????
?   On Map View    ?
?  Forest = Saved! ? ????? Visual indicator
????????????????????
         ?
         ? Click Forest Area
         ?
???????????????????????????????????????????????????????????
?  RE-ENTER FOREST                                        ?
???????????????????????????????????????????????????????????
?  1. MapController.EnterArea("ForestArea") called       ?
?  2. SceneManager loads "ForestArea" scene              ?
?  3. Scene loaded ???                                   ?
??????????????????????????????????????????????????????????
                     ?
                     ?
         ???????????????????????????
         ? PlayerSpawnManager.Start()?
         ?  (runs automatically)    ?
         ????????????????????????????
                     ?
                     ?
         ???????????????????????????????????????????????????
         ?  RESPAWN LOGIC                                  ?
         ???????????????????????????????????????????????????
         ?  1. Find SaveManager.Instance                  ?
         ?  2. Get SaveData                               ?
         ?  3. Check saveStationPosition != Vector3.zero  ?
         ?  4. Find Player GameObject (tag: "Player")     ?
         ?  5. player.transform.position = (10, 0, 15)   ?
         ?  6. Restore health: 80/100                     ?
         ?  7. Restore skills: Level 5                    ?
         ???????????????????????????????????????????????????
                     ?
                     ? ? Spawn Complete!
                     ?
         ????????????????????????
         ?  PLAYER AT SAVE      ?
         ?  STATION LOCATION!   ? ????? Exact position!
         ?    (10, 0, 15)       ?
         ????????????????????????
                     ?
                     ?
                     ?
         ????????????????????????
         ? Continue playing from?
         ?  where they saved!   ?
         ????????????????????????
```

---

## ?? Component Responsibilities

```
??????????????????????????????????????????????????????????
?  SaveStation.cs                                        ?
??????????????????????????????????????????????????????????
?  • Detects player proximity                           ?
?  • Shows interaction prompt                           ?
?  • Triggers SaveManager when player presses E         ?
?  • Records its own position                           ?
??????????????????????????????????????????????????????????

??????????????????????????????????????????????????????????
?  SaveManager.cs                                        ?
??????????????????????????????????????????????????????????
?  • Manages save/load operations                       ?
?  • Stores saveStationPosition in SaveData             ?
?  • Writes JSON to disk                                ?
?  • Provides GetCurrentSaveData()                      ?
??????????????????????????????????????????????????????????

??????????????????????????????????????????????????????????
?  SaveData.cs                                           ?
??????????????????????????????????????????????????????????
?  • Data structure for save files                      ?
?  • Contains saveStationPosition field                 ?
?  • Serializable to JSON                               ?
??????????????????????????????????????????????????????????

??????????????????????????????????????????????????????????
?  PlayerSpawnManager.cs ? NEW                          ?
??????????????????????????????????????????????????????????
?  • Runs on scene load (Start method)                  ?
?  • Reads SaveData                                      ?
?  • Positions player at saveStationPosition            ?
?  • Restores health and skills                         ?
?  • Debug visualization (green sphere)                 ?
??????????????????????????????????????????????????????????

??????????????????????????????????????????????????????????
?  MapController.cs                                      ?
??????????????????????????????????????????????????????????
?  • Manages map UI                                      ?
?  • Highlights saved area                              ?
?  • Loads gameplay scenes                              ?
??????????????????????????????????????????????????????????
```

---

## ?? Position Tracking

```
SAVE EVENT:
???????????????????????????????????????????
?  SaveStation at position: (10, 0, 15)   ?
?  Player near station: (10.2, 0, 15.1)   ?
???????????????????????????????????????????
                ? Save triggered
                ?
???????????????????????????????????????????
?  SaveData.saveStationPosition           ?
?  = SaveStation.transform.position       ?
?  = (10, 0, 15) ??? Exact station pos    ?
???????????????????????????????????????????
                ? Saved to JSON
                ?
???????????????????????????????????????????
?  save_0.json                            ?
?  {                                      ?
?    "saveStationPosition": {             ?
?      "x": 10.0,                        ?
?      "y": 0.0,                         ?
?      "z": 15.0                         ?
?    }                                    ?
?  }                                      ?
???????????????????????????????????????????
                ?
                ? Later...
                ?
RESPAWN EVENT:
???????????????????????????????????????????
?  PlayerSpawnManager.CheckAndSpawnPlayer()?
???????????????????????????????????????????
                ? Reads SaveData
                ?
???????????????????????????????????????????
?  player.transform.position              ?
?  = saveData.saveStationPosition         ?
?  = (10, 0, 15) ??? Exact match!         ?
???????????????????????????????????????????
```

---

## ?? Decision Tree

```
WHEN SCENE LOADS:
?
?? SaveData exists?
?  ?
?  ?? NO  ??? Use default spawn point
?  ?
?  ?? YES ??? Continue
?              ?
?              ?? saveStationPosition == (0,0,0)?
?              ?  ?
?              ?  ?? YES ??? Use playerPosition (or default)
?              ?  ?
?              ?  ?? NO ??? ? Spawn at save station!
?              ?             ?
?              ?             ?? Set player position
?              ?             ?? Set player rotation
?              ?             ?? Restore health
?              ?             ?? Restore skills
?              ?
?              ?? Done!
```

---

## ?? Multiple Save Stations

```
Forest Scene:
?
?? Station A (Entrance)    ? Position: (5, 0, 10)
?? Station B (Camp)        ? Position: (50, 0, 30)
?? Station C (Boss Area)   ? Position: (90, 0, 60)

SCENARIO 1:
Player saves at Station A
SaveData.saveStationPosition = (5, 0, 10)
Return from map ? Spawn at Station A ?

SCENARIO 2:
Player saves at Station B
SaveData.saveStationPosition = (50, 0, 30)
Return from map ? Spawn at Station B ?

SCENARIO 3:
Player saves at Station C
SaveData.saveStationPosition = (90, 0, 60)
Return from map ? Spawn at Station C ?

? Always spawns at LAST USED station!
```

---

## ?? Debug Visualization

```
WITH DEBUG MODE ENABLED:

Scene View:
???????????????????????????????????????
?                                     ?
?         ??  Forest Scene  ??        ?
?                                     ?
?         ?? ? Green Sphere           ?
?         ?  (Spawn Point)            ?
?         ?                           ?
?         ?                           ?
?    [Save Station A]                 ?
?         at (10, 0, 15)              ?
?                                     ?
?                                     ?
?                                     ?
???????????????????????????????????????

Console Output:
[PlayerSpawnManager] ? Spawned player at save station: (10, 0, 15)
[PlayerSpawnManager] Nearest save station distance: 0.05m
[PlayerSpawnManager] Restored health: 80/100
[PlayerSpawnManager] Restored skills - Level: 5
```

---

## ? System Integration

```
                    ???????????????
                    ? SaveStation ?
                    ???????????????
                           ? Records position
                           ?
                    ???????????????
                    ? SaveManager ?
                    ???????????????
                           ? Stores in SaveData
                           ?
                    ???????????????
                    ?  SaveData   ? ??? JSON on disk
                    ???????????????
                           ? Loaded on scene load
                           ?
              ??????????????????????????
              ? PlayerSpawnManager     ?
              ??????????????????????????
                           ? Reads position
                           ?
              ??????????????????????????
              ?  Player.transform      ? ??? Positioned!
              ??????????????????????????
```

---

## ?? User Experience Timeline

```
Time    Event                     Result
????????????????????????????????????????????????
0:00    Play game                Player spawns at default
0:30    Walk to save station     Prompt appears
0:35    Press E                  Game saved! ?
1:00    Press M                  Map opens
1:10    Explore map              See saved area highlighted
1:30    Click Forest             Load Forest scene
1:31    Scene loads              PlayerSpawnManager runs
1:32    Position set             Player at save station! ?
1:33    Continue playing         No time wasted walking!
```

---

**Visual guide complete!** Use this to understand how all components work together! ??
